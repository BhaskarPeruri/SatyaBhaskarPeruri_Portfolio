<!DOCTYPE html><!--xOmyQrz477VMR99oMhEMM--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/8a80e7184ad3a13f.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/chunks/3aecbadcd45aebe7.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/4995e6db2daa090b.js"/><script src="/_next/static/chunks/7040e0a9a37df246.js" async=""></script><script src="/_next/static/chunks/01e9332dc3878a61.js" async=""></script><script src="/_next/static/chunks/32f4ce06fb5da485.js" async=""></script><script src="/_next/static/chunks/d995f95b0c6e0b87.js" async=""></script><script src="/_next/static/chunks/turbopack-503fe7d176a0168c.js" async=""></script><script src="/_next/static/chunks/13f8b9b460cab25b.js" async=""></script><script src="/_next/static/chunks/cc162e5663281663.js" async=""></script><script src="/_next/static/chunks/db909c0d74f8c046.js" async=""></script><script src="/_next/static/chunks/b05a5109468bf8e7.js" async=""></script><script src="/_next/static/chunks/63bdf154c4daac0e.js" async=""></script><meta name="next-size-adjust" content=""/><title>Satya Bhaskar Peruri</title><meta name="description" content="Security researcher, auditor, and blockchain developer specializing in smart contract security and Web3 development"/><meta name="generator" content="Me"/><link rel="icon" href="/sun9.png" media="(prefers-color-scheme: light)"/><link rel="icon" href="/sun9.png" media="(prefers-color-scheme: dark)"/><link rel="icon" href="/sun9.png" type="image/svg+xml"/><link rel="apple-touch-icon" href="/sun9.png"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="font-sans antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","dark",null,["light","dark"],null,true,true)</script><div class="min-h-screen"><header class="fixed top-0 left-0 right-0 z-50 border-b border-primary/20 bg-background/60 backdrop-blur-xl"><div class="absolute inset-0 bg-gradient-to-r from-primary/5 via-accent/5 to-secondary/5 pointer-events-none"></div><div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 relative z-10"><div class="flex h-16 items-center justify-between"><a class="flex items-center gap-2 group" href="/"><div class="relative"></div><span class="font-mono font-semibold text-lg bg-gradient-to-r from-foreground to-primary bg-clip-text">Satya Bhaskar Peruri</span></a><nav class="hidden md:flex items-center gap-8"><a class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors relative group" href="/#about">About<span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-primary to-accent group-hover:w-full transition-all duration-300"></span></a><a class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors relative group" href="/experience">Experience<span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-primary to-accent group-hover:w-full transition-all duration-300"></span></a><a class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors relative group" href="/blogs">Blogs<span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-primary to-accent group-hover:w-full transition-all duration-300"></span></a><a class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors relative group" href="/projects">Projects<span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-primary to-accent group-hover:w-full transition-all duration-300"></span></a><a class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors relative group" href="/opensource">Open Source Contributions<span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-primary to-accent group-hover:w-full transition-all duration-300"></span></a><a class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors relative group" href="/socials">Socials<span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-primary to-accent group-hover:w-full transition-all duration-300"></span></a></nav><button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:text-accent-foreground dark:hover:bg-accent/50 size-9 ml-4 hover:bg-primary/10 border border-primary/20 hover:border-primary/40 transition-all"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0 text-primary"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100 text-primary"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div></div></header><main class="pt-24 pb-16 px-4 sm:px-6 lg:px-8"><article class="mx-auto max-w-4xl"><a data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-9 px-4 py-2 has-[&gt;svg]:px-3 mb-8 gap-2" href="/blogs"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left h-4 w-4"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>Back to Blogs</a><header class="mb-8"><h1 class="text-4xl md:text-5xl font-bold mb-4 text-balance">GCC CTF 2024 web3  challenge writeup</h1><div class="flex flex-wrap items-center gap-4 text-muted-foreground mb-4"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar h-4 w-4"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg><span>2024-04-11</span></div><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock h-4 w-4"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg><span>5 min read</span></div></div><div class="flex flex-wrap gap-2"><span class="px-3 py-1 rounded-md bg-primary/10 text-primary text-sm font-medium">CTF</span><span class="px-3 py-1 rounded-md bg-primary/10 text-primary text-sm font-medium">GCC</span><span class="px-3 py-1 rounded-md bg-primary/10 text-primary text-sm font-medium">web3</span><span class="px-3 py-1 rounded-md bg-primary/10 text-primary text-sm font-medium">writeup</span></div></header><div class="prose prose-lg dark:prose-invert max-w-none"><h1>synthatsu_katana_thief</h1>
<h3>Challenge 1</h3>
<p>2000 years from now, the earth has seen many wars, and the surface of the earth was forever damaged. Humans had to develop floating cities, the first one was Synthatsu, made by what was left of the Japanese history. Mixing futuristic building with a hint of traditional looks. This town was well known for its close combat weapons. One of the most prized katana maker works in that town. But just yesterday, some thugs named Beyond robbed his shop, and took some of his work!</p>
<h3>Goal:</h3>
<p>Will you be able to get them for yourself?</p>
<h3>Challenge.sol</h3>
<pre><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-solidity" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#6a9955">// SPDX-License-Identifier: MIT</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">pragma</span><span> </span><span class="token" style="color:#569CD6">solidity</span><span> </span><span class="token" style="color:#d4d4d4">^</span><span class="token version" style="color:#b5cea8">0.8.0</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">import</span><span> </span><span class="token" style="color:#ce9178">&quot;./KatanaSale.sol&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">contract</span><span> </span><span class="token" style="color:#4ec9b0">Challenge</span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    KatanaSale </span><span class="token" style="color:#569CD6">public</span><span> katanaSale</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">address</span><span> </span><span class="token" style="color:#569CD6">constant</span><span> </span><span class="token" style="color:#569CD6">public</span><span> PLAYER </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">0xCaffE305b3Cc9A39028393D3F338f2a70966Cb85</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">constructor</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">payable</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        katanaSale </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569CD6">new</span><span> </span><span class="token" style="color:#4ec9b0">KatanaSale</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">10</span><span> ether</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">100</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">isSolved</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#569CD6">view</span><span> </span><span class="token" style="color:#569CD6">returns</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">bool</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">if</span><span class="token" style="color:#d4d4d4">(</span><span>katanaSale</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">balanceOf</span><span class="token" style="color:#d4d4d4">(</span><span>PLAYER</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#b5cea8">60</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>            </span><span class="token" style="color:#569CD6">return</span><span> </span><span class="token" style="color:#569cd6">true</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">return</span><span> </span><span class="token" style="color:#569cd6">false</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span></span><span class="token" style="color:#d4d4d4">}</span></code></div></pre>
<h3>KatanaSale.sol</h3>
<pre><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-solidity" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>
</span><span></span><span class="token" style="color:#6a9955">// SPDX-License-Identifier: MIT</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">pragma</span><span> </span><span class="token" style="color:#569CD6">solidity</span><span> </span><span class="token" style="color:#d4d4d4">^</span><span class="token version" style="color:#b5cea8">0.8.0</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">contract</span><span> </span><span class="token" style="color:#4ec9b0">KatanaSale</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span>
<span>    </span><span class="token" style="color:#ce9178">address</span><span> </span><span class="token" style="color:#569CD6">public</span><span> beyond</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">uint256</span><span> </span><span class="token" style="color:#569CD6">public</span><span> katanaPrice</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">uint256</span><span> </span><span class="token" style="color:#569CD6">public</span><span> katanaSold</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">string</span><span> </span><span class="token" style="color:#569CD6">public</span><span> name </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;one-katana&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">string</span><span> </span><span class="token" style="color:#569CD6">public</span><span> symbol </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;KTN&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">uint256</span><span> </span><span class="token" style="color:#569CD6">public</span><span> totalSupply</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">mapping</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">address</span><span> </span><span class="token" style="color:#d4d4d4">=&gt;</span><span> </span><span class="token" style="color:#ce9178">uint256</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> balanceOf</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">event</span><span> </span><span class="token" style="color:#dcdcaa">Sold</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">address</span><span> buyer</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">uint256</span><span> amount</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">constructor</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">uint256</span><span> _katanaPrice</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">uint256</span><span> _totalSupply</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        beyond </span><span class="token" style="color:#d4d4d4">=</span><span> msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        katanaPrice </span><span class="token" style="color:#d4d4d4">=</span><span> _katanaPrice</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        totalSupply </span><span class="token" style="color:#d4d4d4">=</span><span> _totalSupply</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">transfer</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">address</span><span> to</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">uint256</span><span> value</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">external</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">require</span><span class="token" style="color:#d4d4d4">(</span><span>balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> value</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;Insufficient balance&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">-=</span><span> value</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>to</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> value</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">becomeBeyond</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">string</span><span> </span><span class="token" style="color:#569CD6">memory</span><span> passPhrase</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">external</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">require</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#dcdcaa">keccak256</span><span class="token" style="color:#d4d4d4">(</span><span>abi</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">encode</span><span class="token" style="color:#d4d4d4">(</span><span>passPhrase</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">==</span><span> </span><span class="token" style="color:#dcdcaa">keccak256</span><span class="token" style="color:#d4d4d4">(</span><span>abi</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">encode</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;I will check out @BeyondBZH and @gcc_ensibs on X&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        beyond </span><span class="token" style="color:#d4d4d4">=</span><span> msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">buyKatana</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">uint256</span><span> _numberOfKatana</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">external</span><span> </span><span class="token" style="color:#569CD6">payable</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">require</span><span class="token" style="color:#d4d4d4">(</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>value </span><span class="token" style="color:#d4d4d4">==</span><span> _numberOfKatana </span><span class="token" style="color:#d4d4d4">*</span><span> katanaPrice</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;Incorrect Ether value&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        katanaSold </span><span class="token" style="color:#d4d4d4">+=</span><span> _numberOfKatana</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> _numberOfKatana</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">emit</span><span> </span><span class="token" style="color:#dcdcaa">Sold</span><span class="token" style="color:#d4d4d4">(</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">,</span><span> _numberOfKatana</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">endSale</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">external</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">require</span><span class="token" style="color:#d4d4d4">(</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender </span><span class="token" style="color:#d4d4d4">==</span><span> beyond</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;Only a true Beyond can end the sale&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> totalSupply </span><span class="token" style="color:#d4d4d4">-</span><span> katanaSold</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span></code></div></pre>
<h3>Solution:</h3>
<p>To solve this challenge, we need to make the balance of the player greater than or equal to 60, for that follow the steps</p>
<ol>
<li>
<p>When we call the <code>becomeBeyond()</code> with the arguement <strong>I will check out @BeyondBZH and @gcc_ensibs on X</strong>, then we became the beyond.</p>
</li>
<li>
<p>Call the <code>endSale()</code> and we got the totalSupply since we don&#x27;t call the buyKatana().</p>
</li>
</ol>
<h3>Solution Contract</h3>
<pre><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-solidity" style="white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#6a9955">// SPDX-License-Identifier: MIT</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">pragma</span><span> </span><span class="token" style="color:#569CD6">solidity</span><span> </span><span class="token" style="color:#d4d4d4">^</span><span class="token version" style="color:#b5cea8">0.8.0</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">contract</span><span> </span><span class="token" style="color:#4ec9b0">KatanaSale</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span>
<span>    </span><span class="token" style="color:#ce9178">address</span><span> </span><span class="token" style="color:#569CD6">public</span><span> beyond</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">uint256</span><span> </span><span class="token" style="color:#569CD6">public</span><span> katanaPrice</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">uint256</span><span> </span><span class="token" style="color:#569CD6">public</span><span> katanaSold</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">string</span><span> </span><span class="token" style="color:#569CD6">public</span><span> name </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;one-katana&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">string</span><span> </span><span class="token" style="color:#569CD6">public</span><span> symbol </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;KTN&quot;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">uint256</span><span> </span><span class="token" style="color:#569CD6">public</span><span> totalSupply</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">mapping</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">address</span><span> </span><span class="token" style="color:#d4d4d4">=&gt;</span><span> </span><span class="token" style="color:#ce9178">uint256</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> balanceOf</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">event</span><span> </span><span class="token" style="color:#dcdcaa">Sold</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">address</span><span> buyer</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">uint256</span><span> amount</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">constructor</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">uint256</span><span> _katanaPrice</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">uint256</span><span> _totalSupply</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        beyond </span><span class="token" style="color:#d4d4d4">=</span><span> msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        katanaPrice </span><span class="token" style="color:#d4d4d4">=</span><span> _katanaPrice</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        totalSupply </span><span class="token" style="color:#d4d4d4">=</span><span> _totalSupply</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">transfer</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">address</span><span> to</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">uint256</span><span> value</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">external</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">require</span><span class="token" style="color:#d4d4d4">(</span><span>balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> value</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;Insufficient balance&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">-=</span><span> value</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>to</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> value</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">becomeBeyond</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">string</span><span> </span><span class="token" style="color:#569CD6">memory</span><span> passPhrase</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">external</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">require</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#dcdcaa">keccak256</span><span class="token" style="color:#d4d4d4">(</span><span>abi</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">encode</span><span class="token" style="color:#d4d4d4">(</span><span>passPhrase</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">==</span><span> </span><span class="token" style="color:#dcdcaa">keccak256</span><span class="token" style="color:#d4d4d4">(</span><span>abi</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">encode</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;I will check out @BeyondBZH and @gcc_ensibs on X&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        beyond </span><span class="token" style="color:#d4d4d4">=</span><span> msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">buyKatana</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">uint256</span><span> _numberOfKatana</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">external</span><span> </span><span class="token" style="color:#569CD6">payable</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">require</span><span class="token" style="color:#d4d4d4">(</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>value </span><span class="token" style="color:#d4d4d4">==</span><span> _numberOfKatana </span><span class="token" style="color:#d4d4d4">*</span><span> katanaPrice</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;Incorrect Ether value&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        katanaSold </span><span class="token" style="color:#d4d4d4">+=</span><span> _numberOfKatana</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> _numberOfKatana</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">emit</span><span> </span><span class="token" style="color:#dcdcaa">Sold</span><span class="token" style="color:#d4d4d4">(</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">,</span><span> _numberOfKatana</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">endSale</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">external</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">require</span><span class="token" style="color:#d4d4d4">(</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender </span><span class="token" style="color:#d4d4d4">==</span><span> beyond</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&quot;Only a true Beyond can end the sale&quot;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        balanceOf</span><span class="token" style="color:#d4d4d4">[</span><span>msg</span><span class="token" style="color:#d4d4d4">.</span><span>sender</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">+=</span><span> totalSupply </span><span class="token" style="color:#d4d4d4">-</span><span> katanaSold</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">contract</span><span> </span><span class="token" style="color:#4ec9b0">Challenge</span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    KatanaSale </span><span class="token" style="color:#569CD6">public</span><span> katanaSale</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#ce9178">address</span><span> </span><span class="token" style="color:#569CD6">constant</span><span> </span><span class="token" style="color:#569CD6">public</span><span> PLAYER </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">0xCaffE305b3Cc9A39028393D3F338f2a70966Cb85</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">constructor</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">payable</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        katanaSale </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569CD6">new</span><span> </span><span class="token" style="color:#4ec9b0">KatanaSale</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">10</span><span> ether</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">100</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span>    </span><span class="token" style="color:#569CD6">function</span><span> </span><span class="token" style="color:#dcdcaa">isSolved</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#569CD6">public</span><span> </span><span class="token" style="color:#569CD6">view</span><span> </span><span class="token" style="color:#569CD6">returns</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">bool</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">if</span><span class="token" style="color:#d4d4d4">(</span><span>katanaSale</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">balanceOf</span><span class="token" style="color:#d4d4d4">(</span><span>PLAYER</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#b5cea8">60</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>            </span><span class="token" style="color:#569CD6">return</span><span> </span><span class="token" style="color:#569cd6">true</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>        </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">return</span><span> </span><span class="token" style="color:#569cd6">false</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span></span><span class="token" style="color:#d4d4d4">}</span></code></div></pre></div></article></main></div><!--$--><!--/$--><canvas class="fixed inset-0 w-full h-full pointer-events-none z-50"></canvas><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><script src="/_next/static/chunks/4995e6db2daa090b.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[30783,[\"/_next/static/chunks/13f8b9b460cab25b.js\"],\"ThemeProvider\"]\n3:I[6489,[\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/db909c0d74f8c046.js\"],\"default\"]\n4:I[72080,[\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/db909c0d74f8c046.js\"],\"default\"]\n5:I[24390,[\"/_next/static/chunks/13f8b9b460cab25b.js\"],\"default\"]\n6:I[86647,[\"/_next/static/chunks/13f8b9b460cab25b.js\"],\"Analytics\"]\n8:I[45429,[\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/db909c0d74f8c046.js\"],\"OutletBoundary\"]\n9:\"$Sreact.suspense\"\nb:I[45429,[\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/db909c0d74f8c046.js\"],\"ViewportBoundary\"]\nd:I[45429,[\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/db909c0d74f8c046.js\"],\"MetadataBoundary\"]\nf:I[21611,[\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/db909c0d74f8c046.js\"],\"default\"]\n:HL[\"/_next/static/chunks/8a80e7184ad3a13f.css\",\"style\"]\n:HL[\"/_next/static/chunks/3aecbadcd45aebe7.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"xOmyQrz477VMR99oMhEMM\",\"c\":[\"\",\"blogs\",\"GCCCTF2024web3CTFChallengeWriteUp\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blogs\",{\"children\":[[\"slug\",\"GCCCTF2024web3CTFChallengeWriteUp\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/8a80e7184ad3a13f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/3aecbadcd45aebe7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/13f8b9b460cab25b.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"font-sans antialiased\",\"children\":[[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"dark\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"$L5\",null,{}],[\"$\",\"$L6\",null,{}]]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/cc162e5663281663.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/b05a5109468bf8e7.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-2\",{\"src\":\"/_next/static/chunks/63bdf154c4daac0e.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L8\",null,{\"children\":[\"$\",\"$9\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@a\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$Lb\",null,{\"children\":\"$@c\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"$9\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@e\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:I[68275,[\"/_next/static/chunks/13f8b9b460cab25b.js\",\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/b05a5109468bf8e7.js\",\"/_next/static/chunks/63bdf154c4daac0e.js\"],\"Header\"]\n11:I[2879,[\"/_next/static/chunks/13f8b9b460cab25b.js\",\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/b05a5109468bf8e7.js\",\"/_next/static/chunks/63bdf154c4daac0e.js\"],\"BlogContent\"]\n12:T12eb,"])</script><script>self.__next_f.push([1,"\n# synthatsu_katana_thief\n\n### Challenge 1\n\n2000 years from now, the earth has seen many wars, and the surface of the earth was forever damaged. Humans had to develop floating cities, the first one was Synthatsu, made by what was left of the Japanese history. Mixing futuristic building with a hint of traditional looks. This town was well known for its close combat weapons. One of the most prized katana maker works in that town. But just yesterday, some thugs named Beyond robbed his shop, and took some of his work!\n\n### Goal:\n\nWill you be able to get them for yourself?\n\n### Challenge.sol\n\n```solidity\n// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.0;\n\nimport \"./KatanaSale.sol\";\n\ncontract Challenge{\n    KatanaSale public katanaSale;\n    address constant public PLAYER = 0xCaffE305b3Cc9A39028393D3F338f2a70966Cb85;\n\n    constructor () payable {\n        katanaSale = new KatanaSale(10 ether, 100);\n    }\n\n    function isSolved() public view returns(bool){\n        if(katanaSale.balanceOf(PLAYER) \u003e= 60){\n            return true;\n        }\n        return false;\n    }\n\n}\n```\n\n### KatanaSale.sol\n\n```solidity\n\n// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.0;\n\ncontract KatanaSale {\n\n    address public beyond;\n    uint256 public katanaPrice;\n    uint256 public katanaSold;\n    string public name = \"one-katana\";\n    string public symbol = \"KTN\";\n    uint256 public totalSupply;\n    mapping(address =\u003e uint256) public balanceOf;\n\n    event Sold(address buyer, uint256 amount);\n\n    constructor(uint256 _katanaPrice, uint256 _totalSupply) {\n        beyond = msg.sender;\n        katanaPrice = _katanaPrice;\n        totalSupply = _totalSupply;\n    }\n\n    function transfer(address to, uint256 value) external {\n        require(balanceOf[msg.sender] \u003e= value, \"Insufficient balance\");\n        balanceOf[msg.sender] -= value;\n        balanceOf[to] += value;\n    }\n\n    function becomeBeyond(string memory passPhrase) external {\n        require (keccak256(abi.encode(passPhrase)) == keccak256(abi.encode(\"I will check out @BeyondBZH and @gcc_ensibs on X\")));\n        beyond = msg.sender;\n    }\n\n    function buyKatana(uint256 _numberOfKatana) external payable {\n        require(msg.value == _numberOfKatana * katanaPrice, \"Incorrect Ether value\");\n        katanaSold += _numberOfKatana;\n        balanceOf[msg.sender] += _numberOfKatana;\n        emit Sold(msg.sender, _numberOfKatana);\n    }\n\n    function endSale() external {\n        require(msg.sender == beyond, \"Only a true Beyond can end the sale\");\n        balanceOf[msg.sender] += totalSupply - katanaSold;\n    }\n}\n```\n\n### Solution:\n\nTo solve this challenge, we need to make the balance of the player greater than or equal to 60, for that follow the steps\n\n1. When we call the `becomeBeyond()` with the arguement **I will check out @BeyondBZH and @gcc_ensibs on X**, then we became the beyond.\n\n2. Call the `endSale()` and we got the totalSupply since we don't call the buyKatana().\n\n### Solution Contract\n\n```solidity\n// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.0;\n\ncontract KatanaSale {\n\n    address public beyond;\n    uint256 public katanaPrice;\n    uint256 public katanaSold;\n    string public name = \"one-katana\";\n    string public symbol = \"KTN\";\n    uint256 public totalSupply;\n    mapping(address =\u003e uint256) public balanceOf;\n\n    event Sold(address buyer, uint256 amount);\n\n    constructor(uint256 _katanaPrice, uint256 _totalSupply) {\n        beyond = msg.sender;\n        katanaPrice = _katanaPrice;\n        totalSupply = _totalSupply;\n    }\n\n    function transfer(address to, uint256 value) external {\n        require(balanceOf[msg.sender] \u003e= value, \"Insufficient balance\");\n        balanceOf[msg.sender] -= value;\n        balanceOf[to] += value;\n    }\n\n    function becomeBeyond(string memory passPhrase) external {\n        require (keccak256(abi.encode(passPhrase)) == keccak256(abi.encode(\"I will check out @BeyondBZH and @gcc_ensibs on X\")));\n        beyond = msg.sender;\n    }\n\n    function buyKatana(uint256 _numberOfKatana) external payable {\n        require(msg.value == _numberOfKatana * katanaPrice, \"Incorrect Ether value\");\n        katanaSold += _numberOfKatana;\n        balanceOf[msg.sender] += _numberOfKatana;\n        emit Sold(msg.sender, _numberOfKatana);\n    }\n\n    function endSale() external {\n        require(msg.sender == beyond, \"Only a true Beyond can end the sale\");\n        balanceOf[msg.sender] += totalSupply - katanaSold;\n    }\n}\n\ncontract Challenge{\n    KatanaSale public katanaSale;\n    address constant public PLAYER = 0xCaffE305b3Cc9A39028393D3F338f2a70966Cb85;\n\n    constructor () payable {\n        katanaSale = new KatanaSale(10 ether, 100);\n    }\n\n    function isSolved() public view returns(bool){\n        if(katanaSale.balanceOf(PLAYER) \u003e= 60){\n            return true;\n        }\n        return false;\n    }\n\n}\n```\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"div\",null,{\"className\":\"min-h-screen\",\"children\":[[\"$\",\"$L10\",null,{}],[\"$\",\"main\",null,{\"className\":\"pt-24 pb-16 px-4 sm:px-6 lg:px-8\",\"children\":[\"$\",\"$L11\",null,{\"blog\":{\"slug\":\"GCCCTF2024web3CTFChallengeWriteUp\",\"title\":\"GCC CTF 2024 web3  challenge writeup\",\"excerpt\":\"Check out my writeup for the GCC CTF 2024 web3 CTF Challenge WriteUp.\",\"date\":\"2024-04-11\",\"readTime\":\"5 min read\",\"tags\":[\"CTF\",\"GCC\",\"web3\",\"writeup\"],\"image\":\"/gccCTF.jpeg\",\"content\":\"$12\"}}]}]]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"13:I[53960,[\"/_next/static/chunks/cc162e5663281663.js\",\"/_next/static/chunks/db909c0d74f8c046.js\"],\"IconMark\"]\ne:[[\"$\",\"title\",\"0\",{\"children\":\"Satya Bhaskar Peruri\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Security researcher, auditor, and blockchain developer specializing in smart contract security and Web3 development\"}],[\"$\",\"meta\",\"2\",{\"name\":\"generator\",\"content\":\"Me\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/sun9.png\",\"media\":\"(prefers-color-scheme: light)\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/sun9.png\",\"media\":\"(prefers-color-scheme: dark)\"}],[\"$\",\"link\",\"5\",{\"rel\":\"icon\",\"href\":\"/sun9.png\",\"type\":\"image/svg+xml\"}],[\"$\",\"link\",\"6\",{\"rel\":\"apple-touch-icon\",\"href\":\"/sun9.png\"}],[\"$\",\"$L13\",\"7\",{}]]\na:null\n"])</script></body></html>